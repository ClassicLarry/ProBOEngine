using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MathNet.Numerics.LinearAlgebra;
using MathNet.Numerics.LinearAlgebra.Double;
namespace ProboEngine_Stand_Alone_Version
{

    class NNParams
    {
        private Matrix<double> Theta1 { get; set; }
        private Matrix<double> Theta2 { get; set; }
        private Matrix<double> featureMean { get; set; }
        private Matrix<double> featureVar { get; set; }

        private Matrix<double> ETheta1 { get; set; }
        private Matrix<double> ETheta2 { get; set; }
        private Matrix<double> EfeatureMean { get; set; }
        private Matrix<double> EfeatureVar { get; set; }

        public NNParams()
        {
            double[,] means = { {1.53397532e+02,  1.07517165e+02,  1.50754239e+00,  2.07624708e+01,
                      1.94061208e+00, 7.87614596e-01,  6.29553149e+00,  2.49531128e+01,
                      3.23197091e+01,1.61003295e+02,  1.58932105e+01,  1.55970662e+02,
                      7.03311313e+01,  8.81755947e-01,  7.79667655e-01,  2.85384610e-01,
                      4.82027903e-01,  2.59270889e+01,  3.84108062e+01,  8.93187717e+01,
                     - 4.43564907e+00,  2.33298390e+00, - 1.21409341e+01,  1.44740073e+00,
                      2.55542442e-02,  4.62243869e-01,  5.38637528e-01,  2.59268335e+00,
                      3.46979779e-01,  1.13164393e+02,  2.21197480e-01,  2.57280244e-02
                } };
            double[,] vars = {
                {
                    2.68023509e+04, 2.09940400e+04, 3.06087878e-01, 5.90313997e+01,
 1.97829493e+00, 6.66409008e-01, 3.61844644e+01, 2.21218950e+02,
 2.87631930e+02, 7.20049228e+03, 2.35935953e+02, 4.71101760e+03,
 5.45255041e+03, 2.52922794e+00, 7.54948926e+00, 3.61508728e+00,
 8.81835356e+02, 1.72652061e+03, 1.33802495e+03, 4.42342214e+03,
 1.73373982e+02, 3.01859790e+01, 1.34299385e+02, 3.35823353e+01,
 3.65572527e+00, 9.56448365e+00, 9.40966053e+00, 1.60605931e+01,
 4.33977275e+00, 2.09511910e+05, 3.58786549e+00, 2.50660932e-02
                } };

            //added 20 coefficients for bias units to Theta1ANew
            double[,] Theta1A = { {-0.53668221,  0.85659351,  0.83326768, -0.03797237, -0.35495944,
       -0.39164862,  0.49632458, -0.32144104, -0.23328294, -0.3127973 ,
        0.22509168,  0.25997991,  0.06114749,  1.42283824, -0.09919927,
        1.00859536, -0.12526833, -0.28642167,  0.46086505,  0.62091719 },
        { 5.10234931e-02, -1.01285582e-01, -2.46228816e-01,
        -2.84246944e-01,  1.15297191e+00, -7.94151195e-01,
         2.84517353e-01,  3.19541531e-01, -3.24705021e-01,
         2.36380105e-01,  5.80745740e-01, -8.29114105e-02,
        -4.61939827e-03,  7.56732548e-02, -8.46617446e-02,
         4.06426148e-01,  6.10872275e-01, -1.59674778e-01,
         3.99293059e-01,  1.04609074e-01},
       { 1.44190786e-01, -7.30811682e-02,  2.68180617e-01,
         1.11295626e-01,  3.45911665e-01, -2.45916764e-01,
        -1.58514745e-01, -2.70487147e-01, -9.68425397e-01,
        -4.08653032e-01,  5.28710654e-02,  1.26690848e-01,
         3.20645902e-01, -2.49281113e-02, -4.28975204e-01,
         5.36553543e-02,  5.82618432e-01,  9.03561720e-02,
        -4.67650161e-01,  1.04625427e-01},
       {-2.27605744e-01, -2.11457329e-02,  3.26097220e-01,
        -4.48307597e-01,  8.47987745e-02, -1.03678059e-01,
         3.00124883e-01, -9.34378850e-01, -3.38529139e-01,
        -2.79001842e-01,  6.79295866e-01, -1.24587391e+00,
         3.17199634e-01, -1.69662908e-01, -1.36167448e+00,
        -3.36224533e-01,  2.94357258e-01, -5.10048621e-01,
         1.29679604e-02,  4.28554047e-02},
       { 4.79146103e-01,  4.79122784e-02,  3.36929412e-02,
         1.25970480e-01,  3.50089971e-01,  3.35701379e-01,
        -3.89551248e-01, -4.51235246e-01, -1.47859218e-01,
        -8.11546814e-01,  1.67003293e-02,  2.87501383e-01,
         2.81454230e-01,  2.98885665e-01,  1.09371904e-01,
        -5.60285500e-02, -1.09044259e-01,  1.15354380e-01,
        -3.68589658e-01,  2.44864397e-01},
       { 1.86440211e-01,  5.89516566e-01,  6.89441983e-01,
        -1.10495930e+00,  1.15659218e+00,  9.70966108e-01,
        -5.98292138e-01,  1.03182870e+00,  1.52532055e-02,
         3.11489760e-01, -6.46358472e-01,  4.38092841e-01,
        -5.00165455e-01,  8.44638757e-01,  1.23359450e+00,
        -5.58111633e-01, -1.25883491e+00,  3.38225675e-01,
        -8.31025064e-01, -4.21369551e-02},
       { 2.37190457e-01,  2.47916770e-01,  4.78335881e-01,
         3.88344540e-01,  1.15545234e-01,  6.46604447e-01,
         3.41666394e-01, -5.26980501e-01,  5.12834848e-01,
         3.16512412e-01, -3.72483542e-01,  7.22033365e-01,
        -2.31785797e-01, -2.86104601e-01, -8.54024407e-02,
         2.48313901e-01, -4.47691769e-01,  4.75289280e-02,
        -8.44554174e-03,  9.72967744e-02},
       { 3.45994849e-02, -3.25280840e-01, -7.95315647e-01,
        -1.62536953e+00,  2.20507700e-01,  1.57141264e-02,
         3.24977958e-01,  5.29165035e-01, -1.12232901e-01,
         5.17434309e-01, -5.53397928e-01, -3.31152480e-01,
        -1.98388197e-01,  4.33216508e-01, -6.56002991e-02,
         1.23868854e+00, -7.28140068e-01,  4.73881978e-01,
        -3.19906942e-01,  5.47286977e-01},
       { 3.52536597e-01,  1.64695247e-01,  6.01787429e-02,
        -9.68919667e-02,  1.15864735e-01,  5.84238936e-02,
        -6.33481643e-02, -7.00791196e-01, -1.59082476e-01,
        -2.13119225e-02, -6.89403446e-01,  3.00890079e-02,
         6.12441522e-02,  9.75798317e-02, -1.15209470e-01,
        -1.85232180e-03,  3.18734978e-02,  2.94068560e-01,
        -5.91664178e-01,  1.21631229e-02},
       {-1.35127451e-01,  9.91483114e-03, -3.94535099e-01,
        -3.37793644e-01,  1.44507391e-02,  6.44388823e-02,
         1.65181437e-01,  3.40561029e-01, -2.36457412e-01,
         2.09581385e-01,  1.11959031e+00, -3.16552991e-01,
        -9.59865076e-02, -5.69094199e-02,  1.11731918e-01,
         5.16387007e-01, -2.32047354e-01,  3.35056721e-02,
         6.51028656e-01, -2.83166583e-01},
       { 7.12036609e-01, -1.06135205e-01,  2.32543515e-01,
         6.79271182e-02, -5.78105372e-01,  5.71332680e-01,
         7.31352117e-02, -6.93804945e-01, -4.97643338e-02,
        -2.21861016e-01,  1.96740364e-01,  3.68432376e-01,
         2.67028393e-02,  4.80935807e-02,  2.75867794e-01,
         3.43989718e-01,  2.05036846e-01, -2.86314374e-01,
        -3.70621919e-01,  1.56069862e-02},
       { 1.29815513e-01, -1.91070715e-01, -1.15358518e-01,
        -4.07805373e-02,  1.05374321e-01, -1.32007917e-01,
        -3.94119632e-01,  4.08283016e-02, -1.04573450e+00,
         6.68266426e-02,  3.05149736e-01, -7.05818469e-02,
        -5.60107049e-01,  2.34315406e-02, -5.93801608e-02,
         2.57779766e-01, -8.28467248e-02,  7.59147205e-01,
        -3.76374501e-01,  5.85487811e-01},
       { 5.77127700e-03,  3.53976646e-02, -1.15677505e-01,
        -1.02612157e+00,  1.19678490e-01,  9.40133220e-02,
        -1.78509035e-01, -1.20135233e-01, -5.07176487e-01,
         1.38676931e-01, -1.34100007e-01, -2.41539737e-02,
         7.29051010e-02, -3.89096399e-02,  1.95486121e-02,
         1.46994550e-01, -2.04681855e-01,  2.42595643e-03,
        -8.89727056e-02,  4.26112497e-01},
       { 4.90288688e-02, -1.09322594e-01, -8.64164322e-02,
        -5.61985427e-02, -2.20454525e-01,  1.71584179e-01,
        -1.40690279e-01,  1.49651714e-01,  6.19455217e-01,
         8.83966303e-02,  1.45766038e-01,  5.40491254e-02,
        -1.53967248e-01,  9.27278128e-03, -1.45816766e-01,
        -1.15289410e-02, -4.32320335e-01, -2.51581716e-02,
         2.66288615e-01,  1.29923988e-02},
       { 6.88475506e-03,  2.42961488e-02, -3.79118252e-02,
        -1.00544557e+00, -1.27151868e-01,  1.76424204e-01,
         5.79571829e-02,  1.05242859e-01,  3.74629917e-01,
         5.72878011e-02,  3.76933229e-02,  1.57182702e-01,
         2.45280509e-02,  1.36527746e-01,  4.22455337e-03,
         2.94042141e-02, -2.69193457e-01,  1.73818766e-01,
         2.67278695e-02,  8.31666515e-02},
       {-2.26655938e+00,  3.69839018e+00,  2.25383957e+00,
         2.72943581e-01, -2.51695142e+00, -2.00330560e+00,
        -2.31048455e+00, -9.08161035e-01,  1.51132305e+00,
        -2.46403277e+00, -2.57989337e-01, -1.86047067e+00,
        -2.82976792e+00,  2.07479969e+00, -1.62295319e+00,
         2.43568965e+00,  1.27920651e+00, -2.22301825e+00,
         1.97740257e+00,  1.86685266e+00},
       {-1.93867795e-01,  3.93285674e-01,  4.96958881e-01,
         5.36962640e-01, -4.13352293e-01, -2.82451364e-01,
        -1.47619893e+00, -5.37245493e-01,  7.27328112e-01,
        -4.74421104e-01,  4.36004175e-01, -9.20351714e-01,
        -1.22204165e+00, -3.85743907e-01, -9.18101081e-01,
         1.46504039e-01,  8.39213525e-01, -4.78281538e-01,
         4.88334544e-01, -3.33815391e-01},
       {-8.11379053e-03, -4.37697783e-01, -5.79719257e-02,
        -2.56758734e-01, -6.01084075e-01,  1.82644279e-01,
        -3.19642381e-01,  2.03044628e-01, -1.45324740e-01,
        -8.43183331e-02,  1.39001184e-01, -9.14058211e-02,
         4.70542722e-02,  6.67450590e-02,  4.81149275e-02,
         4.54304368e-01,  1.67405210e-01, -1.77444698e-01,
         5.18141276e-02, -1.66877209e-01},
       { 9.52780142e-02,  2.28594137e-01,  6.95602242e-02,
        -4.88704006e-01, -5.46011846e-02, -8.96897929e-02,
        -4.57693232e-01,  1.16478862e-01, -6.48731462e-02,
         1.14258482e-01,  9.56330887e-02, -1.96006167e-01,
         4.99804574e-02,  1.69133961e-01, -4.00917665e-01,
        -2.24398107e-01, -6.16166989e-01,  3.27510532e-01,
        -2.65014409e-01, -5.10452191e-02},
       { 3.79580927e-01, -5.58629101e-02, -4.14006950e-01,
         1.85569924e-01,  7.06298537e-02,  5.05440024e-01,
        -4.18711358e-01, -2.57266448e-01,  1.37891295e-01,
        -1.27215383e-02, -1.15519650e-01, -1.43245406e-01,
        -3.90502963e-01, -4.55023199e-01,  3.40266619e-01,
         4.85170756e-01,  1.64937999e-01, -3.03886397e-01,
         4.39704599e-01, -1.74367951e-01},
       {-2.75898957e-01,  5.12987057e-02, -5.44536158e-01,
         2.19966290e-01,  2.24610921e-01,  8.05376855e-01,
         3.90068352e-01, -2.85168148e-02, -1.83123515e-01,
         2.90799596e-01, -8.75171331e-02, -2.32648608e-02,
        -7.75631342e-01, -2.53421499e-01, -1.01795638e-01,
         1.70657952e-01, -1.00302519e-02,  2.62222985e-01,
        -6.74448292e-02, -2.75374515e-01},
       { 3.48474500e-01, -8.85018794e-02,  7.46082255e-01,
         1.54927242e-01, -3.76942560e-02, -8.05143741e-02,
        -2.89853146e-01, -3.90601665e-02,  2.08345346e-01,
        -1.39948249e-01,  4.32613446e-01, -1.39459927e-01,
        -6.23431981e-02, -3.08551918e-01, -1.31764169e-01,
        -1.59240725e-01,  1.71283731e-01, -2.77208895e-01,
         1.38224480e-04, -3.18713832e-01},
       {-4.24485826e-01, -2.37084041e-01, -6.10787578e-03,
         1.57075754e-01, -3.45637730e-01, -5.95996113e-01,
        -3.85223178e-01,  1.48614035e-01,  6.95159517e-02,
        -1.42878174e+00, -4.15644740e-01,  5.10354295e-01,
         2.44727496e-01,  2.99500322e-01,  1.40184830e-01,
        -4.00460312e-01,  8.89753211e-01, -2.56317540e+00,
        -5.25837027e-01, -3.84990378e-01},
       {-1.83705432e-01, -1.94517264e-01,  1.29234332e-01,
         3.43799630e-02,  1.15175760e-01, -1.58811680e-01,
        -4.11470339e-01, -3.11047223e-01,  2.70742058e-01,
         1.06478695e-01, -1.10879649e-01, -1.31831655e-01,
         5.23124895e-01, -1.87322798e-01, -1.66819786e-02,
         4.06627794e-01,  5.86735429e-01, -5.04549926e-01,
         8.53319835e-02, -7.95238595e-02},
       {-5.97512662e-01, -1.56297201e-02,  3.34561220e-02,
         3.15573990e-01,  4.97811209e-02, -6.04664387e-01,
         8.14347036e-01,  7.32164815e-03,  1.51584060e-01,
        -8.35734910e-03, -1.57039523e-01,  8.04761507e-01,
        -3.58782734e-01, -7.74769719e-02, -1.04579565e+00,
         1.08702282e+00,  4.36133980e-01,  8.86505811e-01,
        -6.30483232e-01,  5.00608262e-02},
       { 1.27849060e-01,  3.00367105e-01,  1.08958066e-02,
         3.02206337e-01, -1.21283619e-01,  2.14180902e-01,
         2.81773748e-01, -1.61398946e-01,  7.65785296e-01,
         7.81231446e-01,  7.16672049e-01, -1.04399942e-01,
         2.66521206e-01, -1.29215380e-02,  3.40237996e-01,
         5.53476810e-02,  4.29164107e-02, -4.91505152e-02,
        -1.15289169e-01,  2.40725613e-02},
       {-4.47093493e-01, -3.04826514e-02, -2.45330551e-01,
         2.75825444e-01,  6.82516836e-02, -3.84186931e-02,
         1.63305375e-02, -3.92919501e-02, -1.51944330e-01,
         2.65544664e-02,  2.18754558e-01, -1.22754260e-01,
        -8.09562695e-02, -2.52204427e-01, -2.45467903e-01,
         2.43315477e-01,  2.01643128e-01,  2.90210821e-02,
        -7.47325725e-03, -2.76596526e-01},
       {-6.15424795e-01, -1.43973097e-01,  9.62833266e-03,
        -4.28822144e-01,  1.26954410e-01, -1.81361562e-02,
         3.93145203e-01, -1.05269631e-01, -8.55474980e-01,
        -5.14739764e-01,  2.71162236e-01, -2.95926999e-01,
        -1.39212662e-01,  9.47004557e-02, -4.25487899e-01,
         1.03134844e-01, -1.18241273e-01, -4.16056289e-02,
        -2.50647311e-02, -1.01400933e+00},
       { 3.89524291e-02,  3.94814799e-02,  4.44933033e-02,
         1.52781598e-01,  1.58014250e-01, -4.57191875e-01,
         9.48522038e-01,  6.83193089e-01,  4.15515312e-02,
         7.15908466e-01, -1.02721762e-01, -6.94083494e-01,
        -5.69074586e-01,  4.66567868e-01,  2.01647527e-01,
        -2.71074216e-01, -4.47533646e-01,  5.52608343e-01,
        -2.23150683e-01, -3.81966045e-01},
       {-1.18655170e-01, -1.41162384e+00, -1.37845052e-01,
         8.38803149e-01,  1.51947926e-01,  4.59899861e-01,
         2.93283196e-01,  6.81240683e-01,  3.46201040e-01,
        -1.38532291e-01, -9.66090895e-01, -3.06228028e-01,
        -8.40022692e-02, -5.84625374e-02,  2.86079604e-01,
        -2.16283149e+00,  9.28272061e-01, -7.11241160e-01,
        -1.06767502e+00, -4.00223022e-01},
       { 1.75312619e-01, -2.28623934e+00, -1.98422299e-02,
        -4.59472304e-02,  5.06291056e-01, -1.86263942e-02,
         3.40717874e-01, -1.39617635e-02, -7.97392125e-02,
        -3.92110548e-01,  8.31101681e-01,  1.85971597e-01,
         2.99998338e-03,  4.51555590e-01,  1.58033402e-01,
         1.59608409e-01, -2.28036948e-02, -8.13459608e-01,
        -1.39576306e-01, -1.29292585e-01},
       {-2.82370607e+00,  9.08228860e-01,  1.22493655e+00,
         7.20693821e-01, -8.34557676e-03, -2.74474453e+00,
        -7.40870152e-01,  6.07719655e-01, -6.97702344e-01,
         2.87132438e-01,  1.61009292e+00, -2.80487577e-01,
        -1.68371156e+00, -7.02726177e-01, -9.99739837e-01,
        -2.01538919e+00,  2.53081949e-01, -4.81828521e-01,
        -4.89680164e-01,  6.36016197e-01},
       { 9.90440694e-01, -5.97071667e-01, -2.63109318e-01,
        -1.13635401e-01,  3.22461502e-01,  6.95063036e-01,
        -2.02820820e-01,  5.42339571e-01,  3.64289089e-02,
         5.13176733e-01, -3.69100976e-01,  4.13489536e-01,
         4.11970987e-01, -1.54883529e+00,  1.11306102e+00,
        -5.67110926e-01, -3.68674261e-02,  1.22199005e+00,
        -4.39275564e-01, -9.11019025e-01}};

            double[,] Theta2A = { { -0.32065051 },{ 1.52288131},
       {-2.65671909},
       {-1.47383612},
       {-1.15107613},
       { 1.33098775},
       { 1.14208111},
       { 1.26933404},
       { 1.72613189},
       {-1.32440872},
       { 1.35319354},
       {-1.05836087},
       { 1.2918553 },
       { 1.51978904},
       {-1.43547185},
       { 1.27054479},
       {-1.70366356},
       {-1.08294072},
       { 1.40927258},
       {-1.08860514},
       {-1.32345864}};
            featureMean = Matrix<double>.Build.DenseOfArray(means);
            featureVar = Matrix<double>.Build.DenseOfArray(vars);
            Theta1 = Matrix<double>.Build.DenseOfArray(Theta1A);
            Theta2 = Matrix<double>.Build.DenseOfArray(Theta2A);
        }
        public double[] decisionRanking(Matrix<double> featureArray)
        {

            //1 should have already been added to start of array for bias unit
            //featureArray->[;;;;;;;;] (vertical)
            //Theta1->Weights for first Layer -> [..(10)...;......;......] (18 rows for 18 neurons, 10 colomns for each neuron
            Matrix<double> std = featureVar.PointwiseSqrt();
            //standardize features by mean and std of training data
            Matrix<double> subtract = (featureArray - featureMean);
            Matrix<double> featureArray1 = (subtract).PointwiseDivide(std);
            //Matrix<double> featureArray1 = (featureArray - featureMean).PointwiseDivide(featureVar.PointwiseSqrt());
            //add ones column
            Matrix<double> ones = Matrix<double>.Build.Dense(1, 1, 1);
            featureArray = ones.Append(featureArray1);

            Matrix<double> a2 = featureArray * Theta1;
            //perform relu function
            a2 = (a2.PointwiseAbs() + a2) / 2;
            //add ones for bias unit
            Matrix<double> ones2 = Matrix<double>.Build.Dense(1, 1, 1);
            a2 = ones2.Append(a2);
            //multiple by next set of weights
            Matrix<double> a3 = a2 * Theta2;
            //perform relu function
            a3 = (a3.PointwiseAbs() + a3) / 2;
            //return output
            int spot = 0;
            double[] finalVals = new double[5];
            foreach (var item in a3.EnumerateIndexed())
            {
                finalVals[spot] = item.Item3;
                spot++;
            }
            return finalVals;
        }

        public double[] econDecisionRanking(Matrix<double> featureArray)
        {
            initializeEconElements();
            //1 should have already been added to start of array for bias unit
            //featureArray->[;;;;;;;;] (vertical)
            //Theta1->Weights for first Layer -> [..(10)...;......;......] (18 rows for 18 neurons, 10 colomns for each neuron
            Matrix<double> std = EfeatureVar.PointwiseSqrt();
            //standardize features by mean and std of training data
            Matrix<double> subtract = (featureArray - EfeatureMean);
            Matrix<double> featureArray1 = (subtract).PointwiseDivide(std);
            //Matrix<double> featureArray1 = (featureArray - featureMean).PointwiseDivide(featureVar.PointwiseSqrt());
            //add ones column
            Matrix<double> ones = Matrix<double>.Build.Dense(1, 1, 1);
            featureArray = ones.Append(featureArray1);

            Matrix<double> a2 = featureArray * ETheta1;
            //perform relu function
            a2 = (a2.PointwiseAbs() + a2) / 2;
            //add ones for bias unit
            Matrix<double> ones2 = Matrix<double>.Build.Dense(1, 1, 1);
            a2 = ones2.Append(a2);
            //multiple by next set of weights
            Matrix<double> a3 = a2 * ETheta2;
            //perform relu function
            a3 = (a3.PointwiseAbs() + a3) / 2;
            //return output
            int spot = 0;
            double[] finalVals = new double[5];
            foreach (var item in a3.EnumerateIndexed())
            {
                finalVals[spot] = item.Item3;
                spot++;
            }
            return finalVals;
        }
        private void initializeEconElements()
        {
            double[,] means = { {1.17568395e+02,  7.54142886e+01,  1.43907533e+00,  1.95951606e+01,
  1.35255653e+00,  4.40097940e-01,  3.81283307e+00,  2.13810745e+01,
  2.73605214e+01, -1.18238750e+01,  1.40623475e+01,  3.20065553e+01,
  8.70774491e+01, -2.81877084e-01,  2.85504218e+00, -2.34828020e+01,
  1.96411283e-01,  4.56633853e+00,  1.13606304e+00,  8.00562588e+02,
  7.51315777e-01, -2.13958136e-02,  2.14694243e-02,  3.47062518e-02,
  1.91092692e+00,  5.52725879e+00,  1.74638838e+00,  5.67429906e+02,
  1.35645349e+00, -7.17686925e-02,  3.42109785e-01,  3.67547092e-01,
  4.29814050e-01, -1.10803111e+01,  1.45053975e+01,  3.23718571e+01,
  8.68819568e+01, -3.08706396e-01,  3.27588684e+00, -1.73028513e+01,
  8.66035871e-01, -3.38337965e-02,  1.03011922e-01,  1.26591939e-01,
  2.41037032e-01, -1.14366108e+01,  1.43163751e+01,  3.22244591e+01,
  8.70448038e+01, -3.19492429e-01,  2.88490736e+00, -2.28664215e+01,
  2.16124572e-01,  4.48849087e+00,  1.09540795e+00,  8.29059711e+02,
  7.18446433e-01} };
            double[,] vars = {{2.05834386e+04, 1.63621191e+04, 3.03151212e-01, 5.08307183e+01,
 1.76016306e+00, 4.50646224e-01, 1.79039430e+01, 1.31922880e+02,
 1.90021299e+02, 1.13701487e+03, 1.66291370e+03, 1.02452036e+03,
 2.53165740e+03, 7.53875967e+01, 2.09241068e+01, 7.09269859e+01,
 9.26597340e+00, 2.37457823e+01, 7.37956465e+00, 2.17737820e+06,
 6.11800603e+00, 3.89743495e-01, 2.59680682e-01, 1.78678049e-01,
 2.36196793e+01, 2.77623098e+01, 1.14752245e+01, 1.75685107e+06,
 1.02981136e+01, 1.77062539e+00, 4.89225628e+00, 4.83070959e+00,
 2.47509244e+00, 1.09616166e+03, 1.60993020e+03, 1.00854712e+03,
 2.55370424e+03, 7.32913917e+01, 3.75626603e+01, 9.39620035e+01,
 2.90199817e+01, 1.15541251e+00, 1.00978385e+00, 9.43377649e-01,
 1.06699311e+00, 1.11748152e+03, 1.63842832e+03, 1.01707914e+03,
 2.54191094e+03, 7.36794360e+01, 2.15366430e+01, 7.79780964e+01,
 9.65607345e+00, 2.34261829e+01, 7.10618440e+00, 2.22018463e+06,
 5.88898957e+00} };

            //added 20 coefficients for bias units to Theta1ANew
            double[,] Theta1A = { {0.36336159,  0.50570097, -0.05978977, -0.62854008, -0.5459053 ,
        0.31085068,  0.32147667,  0.5605521 ,  0.04107933, -2.4383523 ,
        0.30765014,  0.31681039, -0.03937568, -0.70487772, -0.53826805,
        0.04363953,  0.1804479 ,  0.05258866, -0.08007513, -0.69287277},

        {0.2015384649583975,-0.015491732399394774,0.5457870120850206,0.11097724308594188,-0.09354167977296496,-0.3623227800728739,-0.175353151009085,-0.6788099337424606,-0.23487461671786777,-0.03263834670272065,0.3415336425110372,0.1341548815133536,0.07503361442552132,-0.6697433391878169,0.3515380364341626,0.1186196409463837,-0.32992051012278867,0.5691229296378442,0.12442213499727853,-0.28281151006480043},
{-0.3435127916690228,-0.05503336459661438,0.29397045288989887,-0.0394483354782408,0.07278037170428038,0.0969082121304597,-0.14008691643774068,-0.0023877211066800964,0.18152516152623702,-0.011410164561617949,-0.20718706914559443,0.25354843610296085,-0.2224700416281962,0.39995395885181645,0.117058539863191,0.23674075195997327,0.10568346195405269,-0.007110975608716885,-0.017231977728032036,-0.19779196144372535},
{-0.1102373588163217,-0.18228740014351816,-0.06901517349969809,-0.005575128056731695,0.6942338689777625,-0.625701349900218,-0.28773154742385065,-0.9872720564969988,-0.35278508551079374,0.04498216335287129,0.15048035017373515,-0.09225325255491237,-0.5616352032657383,0.2632568564848423,-0.2652958240984567,-0.5194565361767086,0.23217335116070134,0.3678518641996971,-0.33571867998395877,0.47255002241082267},
{0.24935284173879535,0.07403743979479001,-0.2541557306397071,0.18449498764276773,-0.3557947040218436,-0.17109345962233247,-0.35723356236450093,-0.3713242066500139,0.14990170424016513,-0.24217560452855955,-0.03480884294176366,-0.06025116074627548,0.03363562686450784,-0.21889988033198735,-0.05798002327301094,-0.032699310369752106,0.022877604710525773,-1.029967677827365,-0.0785686082271404,-0.26310549382021053},
{-0.5669172440353504,0.49951151479434813,-0.3187940157334457,0.3466084806218537,0.21304941434680513,-0.17936241046366205,-0.15896204555068616,1.0154735062184466,0.5628738392315888,0.318888890586368,-0.1930343621406788,0.09327853187535837,-0.22794188091980563,0.22657320364767464,1.0270794551765783,-0.4082817773519457,1.0269023059586775,-0.7894388862680091,-0.08779671109200689,-0.03641631847380416},
{0.04296975026041,0.0803369949845217,0.0847436640201066,-0.24284089839964218,0.08978916599912841,0.0036073893557998626,-0.1296129195798921,-0.32715417979206474,0.5223564848085333,-0.025603305875974612,0.13423269062240462,-0.187950282846783,-0.2993192246844947,-0.045436470936803273,0.436200686869314,0.43680066329168193,-0.0007572332221917751,0.5528344349559449,0.43206143703537564,0.15221496155779335},
{-0.2530488064431718,0.21649943636883248,-0.18456191833661625,-0.016566488332815692,-0.6754330040194637,-1.529321632318284,-1.3638690676618206,0.025530399551468172,0.0456062741657774,0.06587213129797005,-0.3080088986959643,0.025794441309613416,0.4395570430461869,1.1757624169245025,0.5892914792642543,0.40793509121964894,0.6677829188995877,-0.2778390549373691,-0.9292037367027141,0.046211273278663645},
{0.09895050487757086,-0.08799130308644601,-0.4643428076119896,-0.14274770462852118,-0.6216207130718018,0.21605318028738985,0.7951111007313613,0.4380484395245244,0.4141330014536894,0.07891109552859295,0.5315313726528812,-0.09842702682735134,-0.8237180452071572,-0.4705398199466486,0.010920809249971828,-0.38808079347396096,0.020358886639336347,-0.44800440297819616,0.38767027264875115,-0.16903656572165135},
{0.7083581773957819,0.18125609694513986,0.048694028016872386,0.3790419316009434,0.7942636120797663,-1.266054044134341,-0.7789657123576406,-0.3003050325293704,-0.5506532917925312,0.0817944694755931,-0.2600258044951494,0.5455110997811145,1.2298830275511985,0.38642315273612676,0.3669746744457435,-0.06311431328867738,0.11276394838006965,0.1744026502712903,-0.7676715734202175,-0.37359434554793564},
{-0.043287398721469035,-0.2578936534121937,0.23100701118255487,0.034272753580833364,-0.06068024876450418,-0.036403415001574166,0.364559142988058,-0.19474152341308257,0.2648666280413192,-0.02373550249386299,-0.08052869074678322,0.2636448677748635,0.26424535212332895,0.2239562153500922,-0.3672402141030317,-0.08239480386832697,-0.37188608862185213,0.18590199590561968,0.30032601889489324,0.3393912817235263},
{0.16806442073369574,0.29775259452624153,0.18182545022554497,-0.06326967482912098,0.11141725071001038,-0.4081215815632048,0.07503748825279256,0.02845078017304158,0.301891848403706,0.06121811089242027,0.0753493571949561,0.47177350712231736,-0.4342396728312122,0.2607562892380848,0.16349125748714557,0.2872344124799068,0.2957026915366112,-0.23500533100651363,-0.1759500066857512,-0.010414403066455375},
{0.11895607865466595,-0.10616540250328803,0.04549963960690417,-0.19527507470812705,0.049880016701005295,0.26741942603659646,0.10247121242389412,0.12416811314564588,-0.38413543949072965,0.3583665947757991,-0.27809904066287783,-0.07589376535776769,0.17558815266242608,0.12400964020508522,-0.2482577642413545,-0.14228013131833817,-0.028081890510026356,-0.019625280347125105,0.42892291104053054,0.010058137931981646},
{-0.011816495264990751,0.29123860135243834,-0.09256230521637704,0.07292616869434108,0.036338171762415904,0.08181846763550803,0.04773650636784473,-0.17721754182365204,0.08989217502560451,-0.06561230426392753,0.19495616419570957,-0.2483474113062439,-0.07325161196888584,-0.024754378583829457,0.182384532459237,-0.0740436827769485,0.2102845273352635,-0.09474237606866197,-0.21462269686871283,-0.04987578693645275},
{0.3598804063780912,0.03161263242556189,-0.2471653732923611,0.14120240634326173,-0.1701094191153553,0.036305023915350634,0.19956172537106973,0.2170741942456368,-0.21455521833329005,-0.10205163158895617,0.21083256788798344,0.3642171745800853,-0.18694544875100022,-0.3063154694413695,0.02883851983209663,0.22650810160102353,-0.09022912830577443,-0.13035872896692022,-0.1406077410529679,0.10713337246653093},
{0.17215809966651724,0.27328776253911213,0.010751012105014396,-1.5441310843310971,0.1752135658345751,-0.883976750806788,-0.16958998612244486,-0.19031199448110794,0.19453538618734964,-0.10458770947093109,-0.070405744986444,0.18011956472616503,0.0700417407120968,-0.6622796955015663,0.3673607435003127,0.14072872083824436,0.08510047670008417,-0.24755723841857447,-0.3402095559239738,-0.005889923519878256},
{0.21948726614682224,0.330071475251068,-0.7255893845222151,-0.0770614608757145,0.01154836561425652,0.35518864316843174,0.9276146529255792,0.0695362909329157,-0.3795313507174734,0.2488881256990317,0.908304779083848,0.06487409304115711,-0.27431363747017184,-0.1413271192090565,-0.4621783465276622,0.15200827427628677,-0.8618735355800319,-0.5194347051218919,0.7399586238549075,0.46573326002912624},
{-0.313658513502099,-0.03677490414706065,-0.3234653619654937,0.12636448463138955,0.18875588075487568,-0.5570165163009081,-0.847511243910937,-0.15269261299308917,0.12376733709482113,0.09767857811181668,-0.17870427260280508,-0.009005632603703868,0.2283633160350702,0.052603973489540844,0.10781173889178496,0.1894489142339241,0.06204129519490669,-1.260156436861112,-0.04720262598186003,-0.24994646534207476},
{0.00936608226414496,-0.4003588600635949,0.20327910307895866,-0.06787563398957419,0.04094642635507925,0.0027087110452737972,0.08487549755663054,-0.011660659788582299,-0.03698945810201937,0.1635704120947179,0.06617959171453595,-0.13922011180746377,0.1881100307726075,0.05662517192203113,-0.05311420658662336,-0.2789206450760555,-0.2610952123938737,-0.5663391402238126,0.5060330127648967,0.14471066944699437},
{-0.5547213384856409,-0.31602072551175114,0.2680132239746159,0.05830094987150998,0.4723044976516446,0.21381409081082406,-0.2151327937143735,0.2826596228924642,0.03820283201045842,-1.1151869658793532,-0.519696670663272,0.07078664599550133,0.11833447719168179,-0.1499289456669161,-0.8118645041047163,-0.18528866029869315,-0.35811257599087726,0.03530879898659237,-0.19052030540456963,-0.1837531158123196},
{0.14432551723063025,-0.419544735516218,-0.28762943430851745,0.2081997341104577,-0.2766613476601225,-0.06044677778254493,-0.12760675928919168,0.11924095809322177,-0.26982390813585877,-0.02293680896340932,-0.5264157833519736,0.0709533781457506,0.08929852778156024,-0.004019862251836561,0.03817961003361516,-0.26849831960056825,0.042742609224481046,0.084530825250769,-0.14099144193452895,-0.5276745808283995},
{0.07335881210549472,1.174927801498991,-0.19008682088346993,0.48311610063866556,-0.3309622325860784,0.8340962255833773,0.8202706938384408,0.29659748994008267,0.5291364292798642,-1.3706446902920641,1.246169863611126,0.13263819661411527,-0.33299060165886013,-1.122954978348658,-1.5906119700916883,-0.10215938312219519,-0.17484319238102586,-0.0014324196195259196,-0.9492273567187264,-0.7615080567459231},
{-0.13052725350810798,-0.13799761566468982,-0.3919914497798651,0.05506517856626705,0.23780910154117785,-0.1788095960831941,0.05699370377156792,-0.15380536323282484,0.09811135645547658,-0.04481567125374308,0.14497532938096952,-0.07956153603171791,-0.04349055663743614,-0.04331421931924776,-0.19264654513130636,-0.10609139082825297,-0.0675664086472467,0.018031748044783073,0.14286845553042074,0.2156420796536982},
{0.10418915994490471,0.04329787327274749,-0.05250507998338042,-0.00731060152421455,-0.02106170269291968,-0.17731387811452873,-0.17890915136306035,0.06110994151148403,0.011009996787594149,0.018226328315610656,-0.03782843416067232,-0.08044103315699608,-0.07966253733682561,-0.09077973760703231,0.029291372640091455,-0.009098916702636394,0.06542994923642631,0.17097723272439275,0.10521127708964807,0.047114605878340945},
{-0.2465693211656514,0.019945600959525498,-0.004789492305215513,0.07001628867583598,-0.30235553771216617,0.07495277770429917,-0.19897188597779994,-0.08763413857439152,0.11543361215525857,0.135821049805233,0.10795652210498677,0.006151950508853533,0.03655835296433669,-0.0798826748427382,-0.21416883118975702,-0.10860257173518105,0.14403205919884798,-0.190537665714875,-0.01198492516594986,0.15485028590394018},
{1.0940433882967224,0.24254194292518733,-1.8318426961390755,0.5517565866508838,-2.7395011004263905,0.3186181226532564,-0.05446168232542824,0.08999471847624463,-0.01390818621918867,-0.244717094789521,0.2503991662598263,-0.2424832180121606,-2.188438040861694,0.7028764266597907,0.14756397823652995,-0.12434882588408663,-0.19094609639656374,-0.8959984307261444,-0.1386207274135257,0.02121045428021362},
{0.14490709023989282,0.1487319313668134,-0.36257162585655267,0.6511864947846893,-0.07260609868942497,0.17593654826404598,0.5047644057844569,-0.028486042772552064,0.3753566494511017,-1.3082008393291913,0.7127698872185376,0.41136287509040714,0.050676677429721255,-0.32310247900154854,-1.030053554910228,0.5339467682253722,0.4794479433700882,0.08531743448187737,-0.06070301423178237,0.02738139496780115},
{-0.3095105418195845,-0.41724510684962274,0.5341417750333136,-0.10987160710880331,0.08598188851101994,0.15521708105202117,-0.4761422200625959,0.20112170824779943,-0.05921535409617475,-1.2542988450355175,-0.3014972244820824,-0.03800117664662735,0.33947048454427753,0.09609252583466649,-0.8586298961191356,-0.2180834097207997,0.5846305251419431,0.1568894149327119,-0.3265993538060272,0.032956497812461995},
{-0.0006246087719046777,0.15215185343268325,0.16789893767320185,-0.01885253630768097,-0.03447142440320536,-0.34253084977095166,-0.47680500525972763,-0.2019566408932177,-0.5246061804791594,-0.06760461001088135,-0.15699740112249386,-0.006823849363752892,-0.3686765847903615,-0.1444432323657768,-0.11674842668095672,-0.0849104137865085,-0.5666080856674939,0.07112783044887143,0.4120587953259675,-0.8070265815629418},
{0.633908299478634,-0.03467891726389264,0.1603107462037697,0.5800599833065976,-0.5711290853292225,0.011816208899059061,0.3994054481657797,-0.2760439202348847,-0.13532432505937597,-0.3206630121582525,-0.6960664222676086,-0.18148322091108246,-0.09363283675800986,-0.4747146449098457,-1.2302603138664816,0.7262642303647084,0.15346268118130896,0.13401412420977324,-0.7426591858932138,-0.10133996912862452},
{-0.101605844670129,-0.013633609307462177,0.1226068905347787,-0.032657798759686996,-0.222202457414956,0.24385189910774252,-0.21329413942364867,0.018429528462411186,0.11025007547304981,0.015923730433269227,-0.005816357316757592,0.03209919998093174,-0.05927118293251068,-0.19781194868129598,-0.0728294213616009,-0.006074622111316563,0.06107071174040316,0.060755034173215365,0.032269519220403234,0.07918535369071819},
{0.5435832171452716,-0.06101881468545285,-0.005219860701913863,0.11463054152303287,0.16307921414658627,0.4000123365242194,0.36537821285027083,-0.2514524382773134,-0.09820263250415204,-0.054381983277300455,0.04438821538149649,-0.227234613668985,0.28107723122894246,-0.14326770849504375,0.009831240937972765,-0.08183788101655018,-0.1265641997391076,-0.1999429511973601,0.013083274480732373,0.0010063518683384428},
{0.11781644436728883,-0.12510510599698035,0.15424930725961533,0.047051773027787215,-0.44298544998367867,0.02316965124825943,0.2220819890816867,-0.19672908672896608,0.21297667481124308,0.034400166081698255,-0.00610370296009645,0.02858980258598735,0.14608897857683015,0.09701605609858059,-0.08531362499973,-0.009934520468468938,-0.14508351912131062,0.3166957698786289,-0.08843402387616132,0.003338014624380313},
{0.16911519320867932,-0.9810229168887823,-1.133477155273162,-0.7048933410837099,-0.7859811556395007,-0.19822162236006632,0.06913903151266414,0.00040582723266594444,-1.5977539418517823,1.49756059192627,0.22534056270779124,-4.101507846456062,0.27295688883182034,0.48869882263285636,0.1663157983955878,-0.9472647715955597,-1.7473368442248325,-0.40030293101620235,0.5160623356662509,-0.6204929193011689},
{0.0010966200088555833,-0.33803214672607484,-0.24906997349314083,0.15250465560734877,-0.2395036192979196,-0.014759979363064826,0.12408499730011537,-0.042975378016620144,0.18967035580317762,0.13514056638545188,0.10408883228315574,0.33271889726604686,0.10553266842773502,-0.0027945549576308343,-0.4254319702957115,-0.14663355436706677,-0.3775366387493766,0.06985705203668843,0.43955851768630566,0.04126617545036389},
{0.2193101801448774,-0.020753183841330167,-0.3306200323581669,0.3563184767836239,-0.19378588238450806,0.04350942538372261,0.37685913123970455,-0.022796098596202255,0.34643829109430274,-0.3396101986337066,0.3829038811423761,0.41492447892200285,-0.46528404248552485,0.14265392607550423,0.19688923021315924,0.05794201546087078,-0.14604297596297258,-0.25090129587961046,-0.31098541674727,0.009097242756476928},
{-0.09173725690975967,-0.3411652569538523,0.2617022612121056,-0.08730183995817113,-0.19138991941843408,0.4967033188065329,-0.284948252150029,-0.009147817500168893,0.023179859925543788,0.1986760106278288,-0.11459286823484345,-0.11338124243149086,0.29168975110912937,-0.20867294940252692,-0.13245819113699764,0.02537134850794143,0.11781982074648958,-0.11209001250473868,0.09441221228071756,0.15921010331060906},
{0.17713751291760294,0.27193934974380934,-0.016666020253576642,0.10099762849223524,0.04633533543703132,0.029366229517542444,-0.432279590535734,0.21686592851545466,-0.17960153583006766,-0.24546556144215742,0.07676704132275039,0.13214115809571564,0.1394726764493941,0.15829819832691358,-0.16165675059387252,-0.04501317326682443,0.06572813199946502,-0.17889948407310882,-0.12768064254240263,-0.23640636055706205},
{0.07278294369823571,-0.2646858309780758,0.18600982050256604,0.13625601185880795,0.07124136720320022,0.03774978789795377,0.2964119712303914,-0.14961316785723186,-0.0930614504787678,0.06444262270893118,0.07194180388271104,-0.012239703061724182,-0.0568016941286157,-0.0057630264352754425,-0.09023654268579076,0.16046135356761357,0.1836450034981849,-0.11598620419628702,0.1943928668371841,-0.04877812190947787},
{-0.05788166145649493,0.052638524885389164,0.04351527891122999,-1.1996972713003167,0.12745216161216866,-1.056466315381508,0.04792964592172181,-0.027017921718361308,0.08983668003989802,0.04448417083232384,-0.0446344736110344,-0.032801837722702704,-0.07310137643334165,-0.431609563528857,0.35750670296207615,-0.23601931854270367,-0.02439404297174728,-0.3404594969326569,-0.3181442521635556,0.19824658684605867},
{0.339000443028446,-0.1281903189457489,0.3533824241129527,0.1552165136372388,0.30667595827666466,-0.2938008690184263,-0.6096569803322546,0.18842715269956073,0.2083418626177047,-0.0764449126708,-0.585420883869802,0.7151160088079374,-0.21933983175392383,1.1393969442864018,0.2845766648977001,-0.3525070319147023,-0.018084702396812754,0.042321924882005466,-0.0008518241606356112,0.507680448738183},
{0.19941395654360644,-0.23238291547367645,0.025692125963921772,-0.10954570284612807,-0.08646859636419597,-0.19314592612109976,-0.4968535075823939,0.06597138768235944,-0.3639559304934206,0.041155208810088405,0.06842371958883064,-0.015275916445764625,-0.1833378883573798,-0.8162962066085319,-0.23744066162783736,-0.19764087211911535,-0.5844307667968573,0.04370942612278333,0.51435204097843,-0.00377546381480342},
{-0.18694317796460727,-0.07691800510482541,0.2787941181046175,-0.06330448715529155,-0.44072518332619,0.0051411422471740915,0.04906400539079882,0.03618993249869739,0.03776597082080844,-0.011651929928564038,0.016686884606614886,0.09314879093043714,-0.05409270877935246,0.11205243331132819,-0.2275900075201431,0.11430764815103556,-0.20883132353033365,-0.04727487358814434,-0.030913858567699595,0.05425761203852391},
{-0.09075035364147484,-0.12894010246787277,0.15423144379719275,-0.12280448980946312,-0.1048913533598303,0.061958938419900585,-0.17981077957651628,0.12911121990354063,0.18428016560118585,0.02496161729060104,-0.3475751065358025,0.16329834634299767,-0.12487787941917716,-0.1857389393340733,-0.0153484200979115,0.023864890323952212,-0.3882276985862891,0.17804571863543978,0.12445017485997367,-0.4483329356148874},
{-0.038373724038743263,-0.09267110068497936,0.08183460412969919,0.17483313484058816,0.07276229243253285,0.18987568195742557,0.06291622914397539,-0.04960609300565024,-0.3118866093988769,-0.06372960649917275,-0.4963070414737317,0.05457830468336011,0.23545227156220935,0.37207525499763283,0.007544779445526585,-0.03621459952947525,0.04020471356241268,-0.42976119368171395,-0.025198627509114748,-0.5610314208547534},
{-0.6103483229140487,0.147922148179936,-0.603714981426527,0.6997984715940608,-0.5594940025560059,1.514210039143436,2.0166538307298443,-0.08862949472931819,0.20223744863740373,0.7996746845083397,0.2881807684168841,-0.30385155714835005,-1.0121753290181719,0.20381221817230888,-0.48832762957493825,0.16779238978050562,0.12982160211878793,0.03409517526707456,0.7806989831768955,-0.5998208971743131},
{-0.3308427284332516,-0.4559257038706388,0.2766105955366347,0.11922682357672446,-0.08389764099154723,0.33827107611774904,0.15138256512995368,-0.2871146120490248,0.054339073740056434,0.12645857901942872,-0.3614171712482592,0.11968710689535918,-0.07956108930730592,0.04023132501940879,-0.3875218963604186,-0.02962721938166266,-0.3427348134228115,0.042276695445852046,0.3492306331630411,0.40708957803395845},
{0.21074408164338676,-0.033207091953605786,-0.14788580980065044,0.37378353519883817,0.18716678920746263,-0.29479030591042626,0.035284380692365926,0.27129181437612987,0.1852924496860111,-0.09199917058138372,0.044691014480892195,0.006157425748910034,-0.3936704939487981,0.2786951758461678,-0.23282364224491356,-0.12728804880653855,-0.13945068000663,-0.28928689526623463,-0.05648725324640012,-0.2738245709556344},
{0.20728708717632083,-0.055580045253576224,0.2216305135607336,-0.04163261540333882,-0.040506989160250584,0.5452818971251372,0.017263032733620395,-0.17732734910731404,-0.42123783251168334,0.2348691798560732,-0.40044487424166897,0.06950783115544897,0.20998845298263202,0.06174447319283643,-0.023258554554390194,0.04686824738636302,-0.12529106618272637,0.09312978816577888,-0.003933356773775388,-0.2540826996234646},
{0.06454111102853732,0.5554638167123734,-0.1136221565010876,0.02083108792153963,0.013527373349388245,0.16092286006180248,-0.20928544488693238,-0.010288847465695316,-0.0055370795089772626,-0.06827654040461137,0.22318749304324725,-0.08448551460088782,-0.2137288606440294,0.1804756291503292,0.14964828222183799,0.05289731650517067,0.4762348391281817,0.09574536651493283,0.12281117377148895,-0.13088133379238137},
{0.38930547400078214,-0.02850630426903357,0.3377593584860824,0.4239321717520133,-0.17265219456381245,0.035175806633470766,0.058050469812142014,-0.08886242981017319,-0.2810588125996364,-0.14017751788811086,-0.14840165543801168,0.3285320810650429,0.13483370448126206,-0.017156179896605738,-0.02956900577609342,0.1702943559461208,0.01702562256408453,-0.2675607667323155,0.2645512675145406,-0.09720993367012055},
{-0.15350315869721562,0.08843123407464325,0.014735658300086118,-1.417991980221463,0.2885556794303611,-1.1832431172514741,-0.02004153466388502,0.04252002660141494,-0.09147893890872326,-0.02870117372637835,0.08215062741816999,-0.25636279945713925,0.07598312962410898,-0.5267988733992792,0.032076985162527175,-0.0817830863423952,0.21918579665635815,-0.3862891607160956,-0.0656781228016034,-0.13611581732522643},
{0.5026711620075237,0.3546847787344809,-0.09585929207633608,-0.14707484603401225,0.28788964705987574,-0.013202080368936147,0.3433353991849342,0.2589079448342328,0.2415662564461585,-0.07275385480070848,0.4841264289830871,0.2015651201581668,-0.17988267799151186,0.28949382789058126,-0.23126410796426333,0.5055553260819988,-0.8594590990463143,-0.4528349120655345,0.338736367596278,0.46343643028430476},
{-0.09557728087722335,0.06453975702241498,0.1360247053268113,0.12622585612301657,-0.075453365534565,0.30885232050773953,-0.8578761960557305,0.10860477737589751,-0.15886099158981562,-0.13016822791617602,-0.05823537377142435,-0.009008484323617871,-0.3027532356083018,0.20396306013759546,-0.12044364721145254,-0.539175845151549,-0.008907236127579807,-1.269862743247175,0.025431355421487948,9.704080552491449e-05},
{-0.1640608681352219,-0.6868808534765893,0.722528958444206,-0.056707224067228425,-0.04485601827597179,0.12149091349460829,0.15544038525566556,0.013382321336439882,0.0708421136840709,0.3553727800517281,0.0922440951874547,0.11419598134845846,-0.08592775938290305,0.21941967766879747,0.26869672023983265,-0.5071669688115754,0.13454564683766346,-0.2174033044052334,0.559272610554817,0.28672710324651185},
{-0.4843473759865842,-0.40324023484694604,0.19960359302924433,-0.2780319506590766,0.2566486872337003,0.3599118347956227,-0.08412706324191241,-0.24313527501779844,0.20074976192074373,-1.165995360502577,-0.3647546346288804,0.19689175987483915,0.39036892119443833,0.03567415770840764,-1.2369851196538748,0.12174939126101791,-0.47552361800446513,-0.16750981502999646,-0.3683033964341161,-0.16420753439927369},
{-0.3415427349742842,-0.19167466572079245,-0.0076025664907404195,-0.1007094455759195,0.18893544509176105,0.13086815584357442,-0.39692679665503816,0.15494497876573052,0.23835064269972603,-0.01663402770039026,-0.8386339725752584,0.012462342621588591,-0.1315654241583033,0.08094787047789287,-0.0565775474085245,-0.40409243151371693,0.29219307841373726,0.08909837657745866,-0.11986229996725853,-0.8108695615747137},
{0.6115374893423783,1.2927684770768557,0.11842391849941297,0.06963374599452586,-0.30524233728636774,0.789994923676063,0.7211595457703631,0.11689881693866792,0.7619602395203596,-1.5635107904672403,1.18391596523352,0.16164913560766594,-0.2520162819533617,-1.2696634141506702,-1.703420599080547,0.16151865562680404,0.018871374997467546,0.02838940654120223,-0.9270540245175879,-0.1821297893257196}
};

            double[,] Theta2A = { { 0.77885417, 0.2795802, -0.24648132, -0.35201603 },
                { 1.07671984e-01,  5.92176040e-01, -5.18526935e-01,
        -7.33076250e-01},
       { 8.79450845e-01, -1.24900600e+00,  1.19922481e-01,
        -3.68737034e-01},
       { 8.88702389e-03,  8.94115148e-01,  5.48799323e-01,
        -1.60496311e+00},
       { 1.03055754e+00, -7.02572755e-01, -3.30205058e-01,
         3.24787668e-01},
       { 2.95152981e-01,  2.61038388e-01,  6.66624639e-01,
        -1.74401828e+00},
       {-3.97393606e-01,  1.63983903e-01, -1.79550360e+00,
         9.62428599e-01},
       {-3.70315246e-01, -6.93253762e-01, -7.01600409e-01,
         1.32735238e+00},
       { 5.00031619e-01, -1.32146776e+00,  7.58707679e-01,
         1.50055487e-01},
       { 1.10687344e+00, -5.72292035e-01, -1.22334752e+00,
        -2.82812510e-01},
       {-3.24274674e+00,  8.83048823e-01,  2.24843129e+00,
         9.15786017e-01},
       { 3.97749432e-01, -1.13442141e+00,  6.26259907e-01,
         8.52254393e-01},
       { 7.18229853e-01,  2.77157113e-01,  4.20208121e-02,
        -1.36521114e+00},
       { 6.69634703e-01,  1.40188073e-01,  8.94622854e-01,
        -1.38098072e+00},
       {-2.73912242e-01,  5.61531210e-01, -1.29804717e+00,
         7.06037336e-01},
       {-6.83970152e-01, -4.64528900e-02, -1.14871614e-01,
         1.20840280e+00},
       { 9.63944884e-01, -7.41095264e-01, -2.67369896e-01,
        -2.24805807e-01},
       { 5.88087942e-01,  1.01695916e+00, -6.83978634e-01,
        -7.45724860e-01},
       { 1.25526792e-02,  6.28701917e-01, -1.44029889e+00,
        -4.46994325e-01},
       {-1.11441190e+00, -2.09786416e-01,  1.32157564e-01,
         1.27941733e+00},
       { 1.28430941e-04,  1.18141753e+00, -3.18446734e-01,
        -7.99327938e-01}};

            EfeatureMean = Matrix<double>.Build.DenseOfArray(means);
            EfeatureVar = Matrix<double>.Build.DenseOfArray(vars);
            ETheta1 = Matrix<double>.Build.DenseOfArray(Theta1A);
            ETheta2 = Matrix<double>.Build.DenseOfArray(Theta2A);
        }
    }
}
